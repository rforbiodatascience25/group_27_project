---
title: "Presentation"
author: "Emily Möller (s251702), Erine Genilloud (s252025), Mazarine Chambon (s251918), Yann Ducrest (s251889), Hedi Khemakhem (s251900)"
format:
  revealjs:
    theme: moon
    css: styles.css
editor: visual
class: center, middle
---

## Load

```{r}
library("tidyverse")
```

```{r}
phenotype <- readRDS("../data/phenotype_clean.rds")
gen_exp <- readRDS("../data/gen_exp_clean.rds")
data_augmented <- readRDS("../data/data_augmented.rds")
```

article : *Comparison of gene expression patterns across twelve tumor types identifies a cancer supercluster characterized by TP53 mutations and cell cycle defects*

dataset :

-   clinical dataset : phenotype for ovarian cancer

-   gene expression dataset : RNAseq for ovarian cancer

source : The Cancer Genome Atlas (TCGA) ovarian cancer collection

## Clean

-   gene table : remove some genes

```{r}
knitr::kable(head(gen_exp, 8))
```

-   phenotype table : remove some variables (repetitive or useless)

```{r}
phenotype |> slice_sample(n=10)
```

## Augment

::::: columns
::: column
### 1. Reshape

-   Convert gene-expression table **wide → long**\
    (1 row = 1 gene × 1 sample)

### 2. Join

-   Merge **gene expression + clinical phenotype**\
    using the identifier **sample**

### 3. Create

-   `log2_expression` (variance-stabilized)\
-   `age_cat` (young / middle / senior)

**Output:** one **tidy**, **merged**, **augmented** dataset\
(saved as `data_augmented.rds`)
:::

::: column
```{r}
#| echo: true
#| eval: false

gen_exp_long <- gen_exp_clean |>
  pivot_longer(
    cols = -Ensembl_ID,
    names_to = "sample",
    values_to = "expression"
  )



full_data <- gen_exp_long |>
  left_join(phenotype_clean, by = "sample") |>
  relocate(sample, .before = Ensembl_ID)



full_data <- full_data |>
  mutate(
    log2_expression = log2(expression + 1),
    age_cat = case_when(
      age_at_index.demographic < 50 ~ "young",
      age_at_index.demographic < 65 ~ "middle",
      age_at_index.demographic >= 65 ~ "senior",
      TRUE ~ NA_character_
    )
  )

```
:::
:::::

```{r}
data_augmented |>
  select(sample, Ensembl_ID, expression, race.demographic, alive) |>
  slice_head(n = 3) |>
  knitr::kable()
```

## Describe

![](images/age.png)

## Analysis

```{r}
#| echo: true      # show code
#| eval: false     # don’t run it
5

```

```{r}
#| echo: true      # show code
#| eval: true     # run it
5

```
